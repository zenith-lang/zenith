#!/usr/bin/env zenith

main_beg "Start of main()
"
main_beg_len #main_beg;
main_end "End of main()
"
main_end_len #main_end;
middle_beg "Start of middle()
"
middle_beg_len #middle_beg;
middle_end "End of middle()
"
middle_end_len #middle_end;
inner_msg "Inside of inner()
"
inner_msg_len #inner_msg;

$ inner {
    push inner_msg_len;
    push inner_msg;
    push 1;
    push 4;
    syscall;
    ignore;
}

$ middle {
    push middle_beg_len;
    push middle_beg;
    push 1;
    push 4;
    syscall;
    ignore;

    call inner;

    push middle_end_len;
    push middle_end;
    push 1;
    push 4;
    syscall;
    ignore;
}

$ main {
    push main_beg_len;
    push main_beg;
    push 1;
    push 4;
    syscall;
    ignore;

    call middle;
    call middle;

    push main_end_len;
    push main_end;
    push 1;
    push 4;
    syscall;
    ignore;

    push 1;
    syscall;
}
